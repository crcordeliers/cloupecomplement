
# Shiny App for Single-Cell RNA-Seq Data Exploration

## Overview

This Shiny app is designed to complement 10x Genomics Loupe Browser for single-cell RNA-seq data analysis. It provides an intuitive interface for researchers to perform additional data preprocessing, visualization, and downstream analyses, such as differential expression and pathway analysis, after manual clustering in Loupe Browser.

### Key Features:

- **Data Preprocessing:** Load the `outs` folder from your 10x Genomics pipeline and a CSV file containing cluster information. Filter genes based on a minimum expression threshold.
- **Visualization:** Generate violin plots, beeswarm plots, heatmaps, and dot plots to visualize gene expression across clusters. Pairwise comparisons between clusters can be added interactively for violin and beeswarm plots.
- **Differential Expression Analysis:** Perform differential expression analysis between selected clusters.
- **Pathway Analysis:** Explore enriched pathways using results from the differential expression analysis, with interactive visualization of pathway enrichment.

## Installation and Usage

### Prerequisites:

The app use these dependencies, but those should be automatically downloaded when starting the app, if you do not have them yet :

- `shiny`
- `shinydashboard`
- `ggplot2`
- `shinyWidgets`
- `dplyr`
- `ggbeeswarm`
- `Seurat`
- `reshape2`
- `ggpubr`
- `pheatmap`
- `viridis`
- `clusterProfiler`
- `org.Hs.eg.db`
- `biomaRt`
- `fgsea`

### Running the App:

1. **Launch RStudio:**
   Open `app.R` in RStudio.

2. **Run the App:**
   Click the "Run App" button in the top-right corner of the RStudio interface.

3. **Input Files:**
   - **Cluster CSV:** The CSV file generated from Loupe Browser, which contains cluster information.
   - **Outs Folder:** The folder generated by the 10x Genomics pipeline (`CellRanger` output).

### App Workflow:

1. **Data Loading:**
   - Upload the CSV file with cluster information and the `outs` folder.
   - Optionally, apply preprocessing steps, including filtering genes expressed in at least a user-defined percentage of cells.

2. **Visualization:**
   - **Violin & Beeswarm Plots Tab:** Select genes of interest and visualize their expression across clusters with the option to perform pairwise comparisons. Download the plots in PDF format.
   - **Heatmap & Dotplot Tab:** Visualize the expression of selected genes as heatmaps and dotplots, with clusters defined in the metadata.

3. **Differential Expression:**
   - Perform differential expression analysis between selected clusters.
   - View and download the results in table format.

4. **Pathway Analysis:**
   - Choose a pathway analysis method and run enrichment analysis based on the differential expression results.
   - Customize the visualization (e.g., display a limited number of enriched categories).

## Roadmap

### Planned Features:
- <s>**Support for Other Species:** Add the ability to analyze datasets from species other than human and mouse.</s> DONE !
- **Better handling of error** Try to limit the crashing of the app when unexpected input is given (or fatal error).
- <s>**Add a folder select** as for the fileinput so that it limits the selection of non-existant folder path.</s> Too complex, or too ugly (looking at you shinyFiles) to be implemented seamlessly.
- <s>**FGSEA Integration:** Implement the FGSEA (Fast Gene Set Enrichment Analysis) method as an alternative pathway analysis option.<s> DONE !
- <s>**Optimize Pathway Analysis:** Preload the gene annotation (using biomaRt) at the start to avoid reloading it with each new analysis, improving efficiency.<s> DONE !
- **Customizable Pathway Visualization:** Add an option to control the number of categories shown in the pathway analysis plots, with automatic height scaling to accommodate the chosen number.

## Contributions

Feel free to contribute to this project by submitting pull requests or suggesting new features and improvements.
